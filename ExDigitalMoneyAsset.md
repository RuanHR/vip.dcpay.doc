# 			资金接口文档说明



# 版本&更新记录

| 版本号  | 作者 | 日期       | 更新内容                      |
| ------- | ---- | ---------- | ----------------------------- |
| v.1.0.0 | S    | 2019-03-09 | 初始版本                      |
| v.1.0.1 | Z    | 2019-05-22 | 增加生成账户接口,状态确认接口 |

​		

---



# 功能说明

​	此服务提供资金的查询、申请、冻结、消费 、入账功能，资金在使用前必须要先申请冻结（申请冻结是两个接口，但是一个过程，不能分开用,申请是有有效期的)，然后消费，冻结后 因某些原因而不需要消费的，可以解冻。

​	注意事项

​	1.申请和冻结是一起使用的

​	2.申请有超时时间，如果申请超时时间内没有冻结，申请就会失效，需要重新申请

​	3.同一币账户，需要上一次申请冻结后或上一次申请失效后才能继续申请

​	4.同一业务申请后，如果超时未冻结，需要重新申请，且重新申请返回的申请Id是不变的

​	5.同一业务连续申请，返回的是同一个申请id,只是提示信息不一样		

# 1.申请资金

## 1.1基本描述

| 请求方式 | dubbo/rpc                                       |
| -------- | ----------------------------------------------- |
| 请求地址 | applyMoney                                      |
| 功能说明 | 申请资金，与冻结资金同步使用。 申请后需调用冻结 |

## 1.2请求参数

| 参数名       | 类型       | 必填 | 说明     | 跳转                          |
| ------------ | ---------- | ---- | -------- | ----------------------------- |
| assetsId     | Long       | 是   | 币账户ID |                               |
| businessType | Integer    | 是   | 业务类型 | [参数说明](#BusinessTypeEnum) |
| businessId   | String     | 是   | 业务Id   |                               |
| money        | BigDecimal | 是   | 申请金额 |                               |

## 1.3返回结果

| 字段名  | 类型    | 说明                | 跳转 |
| ------- | ------- | ------------------- | ---- |
| success | Boolean | 操作结果 成功失败   |      |
| code    | String  | 返回码              |      |
| msg     | String  | 操作结果描述        |      |
| obj     | Long    | 返回数据:资金申请Id |      |

## 1.4返回值样例

``` java
{
	"success": true,
    "code": "1000",
    "msg": "成功",
    "obj": 209
}
```



# 2.冻结资金

## 2.1基本描述

| 请求方式 | dubbo/rpc                                          |
| -------- | -------------------------------------------------- |
| 请求地址 | freezeMoney                                        |
| 功能说明 | 冻结资金，与申请资金结合同步使用。调用前需要先申请 |

## 2.2请求参数

| 参数名  | 类型   | 必填 | 说明       | 跳转 |
| ------- | ------ | ---- | ---------- | ---- |
| applyId | Long   | 是   | 资金申请Id |      |
| remark  | String | 否   | 冻结描述   |      |

## 2.3返回结果

| 字段名  | 类型    | 说明              | 跳转 |
| ------- | ------- | ----------------- | ---- |
| success | Boolean | 操作结果 成功失败 |      |
| code    | String  | 返回码            |      |
| msg     | String  | 操作结果描述      |      |
| obj     | Boolean | 返回数据          |      |

## 2.4返回值样例

```java
{
	"success": true,
    "code": "1000",
    "msg": "成功",
    "obj": 209
}
```

# 3.解冻资金

## 3.1基本描述

| 请求方式 | dubbo/rpc                      |
| -------- | ------------------------------ |
| 请求地址 | unFreezeMoney                  |
| 功能说明 | 解冻资金（消费失败，资金退回） |

## 3.2请求参数

| 参数名  | 类型   | 必填 | 说明       | 跳转 |
| ------- | ------ | ---- | ---------- | ---- |
| applyId | Long   | 是   | 资金申请Id |      |
| remark  | String | 否   | 解冻说明   |      |

## 3.3返回结果

| 字段名  | 类型    | 说明         | 跳转 |
| ------- | ------- | ------------ | ---- |
| success | Boolean | 操作结果     |      |
| code    | String  | 返回码       |      |
| msg     | String  | 操作结果描述 |      |
| obj     | Boolean | 返回数据     |      |

## 3.4返回值样例

```java
{
	"success": true,
    "code": "1000",
    "msg": "成功",
    "obj": true
}
```

# 4.消费资金

## 4.1基本描述

| 请求方式 | dubbo/rpc                        |
| -------- | -------------------------------- |
| 请求地址 | useMoney                         |
| 功能说明 | 消费资金（冻结后的资金才能消费） |

## 4.2请求参数

| 参数名  | 类型   | 必填 | 说明       | 跳转 |
| ------- | ------ | ---- | ---------- | ---- |
| applyId | Long   | 是   | 资金申请Id |      |
| remark  | String | 否   | 使用描述   |      |

## 4.3返回结果

| 字段名  | 类型    | 说明         | 跳转 |
| ------- | ------- | ------------ | ---- |
| success | Boolean | 操作结果     |      |
| code    | String  | 返回码       |      |
| msg     | String  | 操作结果描述 |      |
| obj     | Boolean | 返回数据     |      |

## 4.4返回值样例

```java
{
	"success": true,
    "code": "1000",
    "msg": "成功",
    "obj": true
}
```

# 5.转移资金

## 5.1基本描述

| 请求方式 | dubbo/rpc                        |
| -------- | -------------------------------- |
| 请求地址 | transferMoney                    |
| 功能说明 | 消费资金（冻结后的资金才能转移） |

## 5.2请求参数

| 参数名           | 类型   | 必填 | 说明         | 跳转 |
| ---------------- | ------ | ---- | ------------ | ---- |
| applyId          | Long   | 是   | 资金申请Id   |      |
| dstCoinAccountId | Long   | 是   | 目标币账户Id |      |
| remark           | String | 否   | 转移描述     |      |

## 5.3返回结果

| 字段名  | 类型    | 说明         | 跳转 |
| ------- | ------- | ------------ | ---- |
| success | Boolean | 操作结果     |      |
| code    | String  | 返回码       |      |
| msg     | String  | 操作结果描述 |      |
| obj     | Boolean | 返回数据     |      |

## 5.4返回值样例

```java
{
	"success": true,
    "code": "1000",
    "msg": "成功",
    "obj": true
}
```

# 6.增加资金

## 6.1基本描述

| 请求方式 | dubbo/rpc |
| -------- | --------- |
| 请求地址 | addMoney  |
| 功能说明 | 增加资金  |

## 6.2请求参数

| 参数名        | 类型       | 必填 | 说明     | 跳转 |
| ------------- | ---------- | ---- | -------- | ---- |
| businessId    | String     | 是   | 业务Id   |      |
| businessType  | Long       | 是   | 业务类型 |      |
| coinAccountId | Long       | 是   | 币账户Id |      |
| money         | BigDecimal | 是   | 金额     |      |
| remark        | String     | 否   | 说明     |      |

## 6.3返回结果

| 字段名  | 类型    | 说明         | 跳转 |
| ------- | ------- | ------------ | ---- |
| success | Boolean | 操作结果     |      |
| code    | String  | 返回码       |      |
| msg     | String  | 操作结果描述 |      |
| obj     | Boolean | 返回数据     |      |

## 6.4返回值样例

```java
{
	"success": true,
    "code": "1000",
    "msg": "成功",
    "obj": true
}
```

# 7.获取账户资金

## 7.1基本描述

| 请求方式 | dubbo/rpc                       |
| -------- | ------------------------------- |
| 请求地址 | getAssets                       |
| 功能说明 | 根据商户Id及币种 获取用户币账户 |

## 7.2请求参数

| 参数名    | 类型   | 必填 | 说明       | 跳转 |
| --------- | ------ | ---- | ---------- | ---- |
| ownerId   | Long   | 是   | 商户Id     |      |
| ownerType | String | 是   | 所有者类型 |      |
| currency  | String | 是   | 币种       |      |

## 7.3返回结果

| 字段名  | 类型        | 说明         | 跳转                         |
| ------- | ----------- | ------------ | ---------------------------- |
| success | Boolean     | 操作结果     |                              |
| code    | String      | 返回码       |                              |
| msg     | String      | 操作结果描述 |                              |
| obj     | CoinAccount | 返回数据     | [参数类型说明](#CoinAccount) |

## 7.4返回值样例

```java
{
	"code": "1000",
	"msg": "成功",
	"obj": {
		"currency": "USD",
		"unfree": 0E-10,
		"ownerId": 31732,
        "ownerType": 1,
		"free": 0E-10,
		"id": 174134
	},
	"success": true
}
```

# 8.根据币账户获取账户资金

## 8.1基本描述

| 请求方式 | dubbo/rpc                      |
| -------- | ------------------------------ |
| 请求地址 | getAssetsById                  |
| 功能说明 | 根据币账户Id获取币账户资金信息 |

## 8.2请求参数

| 参数名   | 类型 | 必填 | 说明     | 跳转 |
| -------- | ---- | ---- | -------- | ---- |
| assetsId | Long | 是   | 币账户Id |      |

## 8.3返回结果

| 字段名  | 类型        | 说明         | 跳转                       |
| ------- | ----------- | ------------ | -------------------------- |
| success | Boolean     | 操作结果     |                            |
| code    | String      | 返回码       |                            |
| msg     | String      | 操作结果描述 |                            |
| obj     | CoinAccount | 返回数据     | [参数类型说明](#CoinAccount) |

## 8.4返回值样例

```java
{
	"code": "1000",
	"msg": "成功",
	"obj": {
		"currency": "BCB",
        "ownerType": 1,
		"unfree": 0E-10,
		"ownerId": 31732,
		"free": 0E-10,
		"id": 174134
	},
	"success": true
}
```

# 9.生成资金账户

## 9.1基本描述

| 请求方式 | dubbo/rpc                                           |
| -------- | --------------------------------------------------- |
| 请求地址 | createAsset                                         |
| 功能说明 | 根据币账户Id以及账户类型生成账户                    |
| 特别说明 | 调用此接口生成的币账户必须再调用一次接口10 激活账户 |

## 9.2请求参数

| 参数名      | 类型    | 必填 | 说明                       | 跳转 |
| ----------- | ------- | ---- | -------------------------- | ---- |
| accountId   | Long    | 是   | 平台或商户ID               |      |
| accountType | Integer | 是   | 平台账户类型 1 平台 2 商户 |      |

## 9.3返回结果

| 字段名  | 类型        | 说明         | 跳转                       |
| ------- | ----------- | ------------ | -------------------------- |
| success | Boolean     | 操作结果     |                            |
| code    | String      | 返回码       |                            |
| msg     | String      | 操作结果描述 |                            |
| obj     | CoinAccount | 返回数据     | [参数类型说明](#CoinAccount) |

## 9.4返回值样例

```java
{
	"success": true,
    "code": "1000",
    "msg": "成功",
    "obj": true
}
```

# 10. 更新币账户状态为激活

## 10.1基本描述

| 请求方式 | dubbo/rpc                                |
| -------- | ---------------------------------------- |
| 请求地址 | updateState                              |
| 功能说明 | 根据币账户Id已经账户类型币种类型生产账户 |
| 特别说明 | 只需要在调用生成币账户后调用一次即可     |

## 10.2请求参数

| 参数名      | 类型    | 必填 | 说明                       | 跳转 |
| ----------- | ------- | ---- | -------------------------- | ---- |
| accountId   | Long    | 是   | 商户ID                     |      |
| accountType | Integer | 是   | 平台账户类型 1 平台 2 商户 |      |

## 10.3返回结果

| 字段名  | 类型        | 说明         | 跳转                       |
| ------- | ----------- | ------------ | -------------------------- |
| success | Boolean     | 操作结果     |                            |
| code    | String      | 返回码       |                            |
| msg     | String      | 操作结果描述 |                            |
| obj     | CoinAccount | 返回数据     | [参数类型说明](#CoinAccount) |

## 10.4返回值样例

```java
{
	"success": true,
    "code": "1000",
    "msg": "成功",
    "obj": true
}
```



# CoinAccount

| 字段      | 类型       | 说明                     |
| --------- | ---------- | ------------------------ |
| id        | Long       | 币账户Id                 |
| ownerId   | Long       | 商户Id                   |
| ownerType | int        | 所有者类型 1 用户 2 财务 |
| free      | BigDecimal | 热钱                     |
| unfree    | BigDecimal | 冷钱                     |
| currency  | String     | 币种code                 |

# BusinessTypeEnum

| businessType | 说明 |
| ------------ | ---- |
| 1            | 支付 |
| 2            | 提现 |
| 3            | 充币 |
| 4            | 提币 |

